<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Control Panel</title>
  <style>
    :root {
      --ink-black: #002029ff;
      --jet-black: #00303dff;
      --dark-teal: #004052ff;
      --dark-teal-2: #005066ff;
      --dark-teal-3: #00607aff;

      --bg-color: var(--ink-black);
      --text-color: #e0e0e0;
      --recording-color: #ff3e3e;
      --processing-color: var(--dark-teal-3);
      --border-color: var(--dark-teal);
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* MAIN STATUS PANEL */
    #status-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      transition:
        background-color 0.4s ease,
        border-color 0.4s ease;
      border-left: 4px solid var(--dark-teal);
      gap: 1px;
    }

    /* STATE BACKGROUNDS */
    .state-idle {
      background-color: var(--ink-black);
      border-left-color: var(--dark-teal);
    }

    .state-recording {
      background-color: rgba(255, 62, 62, 0.15);
      border-left-color: var(--recording-color);
      animation: recording-pulse 1.5s infinite;
    }

    .state-processing {
      background-color: rgba(0, 96, 122, 0.2);
      border-left-color: var(--dark-teal-3);
    }

    .state-transcribing {
      background-color: rgba(0, 96, 122, 0.15);
      border-left-color: var(--dark-teal-2);
    }

    .state-injecting {
      background-color: rgba(0, 80, 102, 0.2);
      border-left-color: var(--dark-teal-3);
    }

    .state-warmup {
      background-color: rgba(255, 200, 0, 0.15);
      border-left-color: #ffc800;
      animation: panel-warmup-pulse 2s infinite ease-in-out;
    }

    @keyframes panel-warmup-pulse {

      0%,
      100% {
        background-color: rgba(255, 200, 0, 0.1);
      }

      50% {
        background-color: rgba(255, 200, 0, 0.25);
      }
    }

    @keyframes recording-pulse {

      0%,
      100% {
        background-color: rgba(255, 62, 62, 0.1);
      }

      50% {
        background-color: rgba(255, 62, 62, 0.25);
      }
    }

    /* HEADER BAR */
    #header-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      background: var(--jet-black);
      border-bottom: 1px solid var(--border-color);
      -webkit-app-region: drag;
      /* Make header draggable */
    }

    #header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    /* Close button */
    #close-btn {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 3px;
      transition: all 0.2s;
      -webkit-app-region: no-drag;
      /* Make button clickable */
      color: #888;
      font-size: 1.2rem;
      line-height: 1;
      font-weight: 300;
    }

    #close-btn:hover {
      background: rgba(255, 62, 62, 0.2);
      color: #ff3e3e;
    }

    #status-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    #status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--dark-teal-3);
      transition: background-color 0.3s;
    }

    .state-recording #status-dot {
      background-color: var(--recording-color);
      animation: dot-pulse 1s infinite;
    }

    .state-processing #status-dot {
      background-color: var(--dark-teal-3);
      animation: dot-spin 1s linear infinite;
    }

    .state-warmup #status-dot {
      background-color: #ffc800;
      animation: dot-warmup 1s ease-in-out infinite;
    }

    @keyframes dot-pulse {

      0%,
      100% {
        opacity: 1;
        transform: scale(1);
      }

      50% {
        opacity: 0.5;
        transform: scale(1.3);
      }
    }

    @keyframes dot-spin {
      from {
        box-shadow: 0 0 0 0 var(--dark-teal-3);
      }

      to {
        box-shadow: 0 0 10px 3px transparent;
      }
    }

    @keyframes dot-warmup {

      0%,
      100% {
        transform: scale(1);
        opacity: 1;
      }

      50% {
        transform: scale(1.4);
        opacity: 0.7;
      }
    }

    .badge {
      font-size: 0.65rem;
      padding: 2px 6px;
      background: var(--dark-teal);
      border-radius: 3px;
      color: var(--text-color);
      font-weight: 500;
      white-space: nowrap;
    }

    #live-message {
      display: none;
      font-size: 0.75rem;
      font-weight: 400;
      margin-left: 8px;
      color: #aaa;
      letter-spacing: normal;
      text-transform: none;
    }

    #badge-auth {
      color: #ff8c00;
      font-weight: 600;
    }

    #badges {
      display: flex;
      gap: 5px;
    }

    /* METRICS CONTAINERS */
    #metrics-container {
      display: flex;
      flex-direction: column;
      gap: 1px;
      background: var(--border-color);
      margin: 0;
      border-top: 1px solid var(--border-color);
    }

    #metrics-row-1 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1px;
      background: var(--border-color);
    }

    #metrics-row-2 {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 1px;
      padding-bottom: 0;
      background: var(--border-color);
    }

    .metric-value.perf-green {
      color: #7aff9e;
      /* Light green */
      font-size: 0.75rem;
      /* Smaller font */
    }

    .metric-cell {
      background: var(--jet-black);
      padding: 4px 2px;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;

    }

    .metric-value {
      font-size: 0.9rem;
      font-weight: 700;
      color: white;
      line-height: 1;
      margin-bottom: 3px;
    }

    .metric-value.perf {
      font-family: 'Consolas', monospace;
    }

    .metric-label {
      font-size: 0.5rem;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      line-height: 1;
    }

    .metric-cell.active {
      background: rgba(0, 96, 122, 0.4);
      box-shadow: inset 0 0 10px rgba(0, 150, 190, 0.2);
    }

    /* TOGGLES */
    #toggles-bar {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 4px;
      padding: 12px 12px 10px 12px;
      background: var(--ink-black);
      align-items: start;
    }

    .toggle-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .toggle-label-text {
      font-size: 0.65rem;
      color: #888;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* MODE TOGGLE */
    #mode-toggle-bar {
      padding: 8px 12px;
      display: flex;
      gap: 8px;
      background: var(--ink-black);
      border-bottom: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
      /* Push content up removed */
    }

    .mode-btn {
      flex: 1;
      padding: 3px 4px;
      background: var(--jet-black);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      color: #888;
      font-size: 0.75rem;
      cursor: default;
      transition: all 0.2s;
      text-align: center;
      font-weight: 600;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 42px;
    }

    .mode-btn:hover {
      background: var(--dark-teal);
      color: white;
    }

    .mode-btn.active {
      background: var(--dark-teal-3);
      color: white;
      border-color: var(--dark-teal-3);
      box-shadow: 0 0 8px rgba(0, 96, 122, 0.5);
    }

    /* WARMUP LOCK */
    .state-warmup #toggles-bar,
    .state-warmup #mode-toggle-bar {
      pointer-events: none;
      opacity: 0.5;
      filter: grayscale(0.5);
      transition: all 0.5s ease;
    }

    .mode-btn .mode-desc {
      display: block;
      font-size: 0.55rem;
      opacity: 0.7;
      margin-top: 2px;
    }

    .toggle-switch {
      position: relative;
      width: 36px;
      height: 20px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #333;
      border-radius: 20px;
      transition: 0.3s;
      border: 1px solid #444;
    }

    .toggle-slider:before {
      content: '';
      position: absolute;
      height: 14px;
      width: 14px;
      left: 2px;
      bottom: 2px;
      background-color: #888;
      border-radius: 50%;
      transition: 0.3s;
    }

    input:checked+.toggle-slider {
      background-color: var(--dark-teal-2);
      border-color: var(--dark-teal);
    }

    input:checked+.toggle-slider:before {
      transform: translateX(16px);
      background-color: white;
    }

    /* FOOTER */
    footer {
      background-color: var(--jet-black);
      padding: 4px 10px;
      font-size: 0.7rem;
      color: #666;
      display: flex;
      justify-content: space-between;
      /* border-top removed */
    }

    .hk-tag {
      font-weight: bold;
      color: var(--text-color);
      padding: 1px 4px;
      background: var(--dark-teal);
      border-radius: 2px;
      font-size: 0.65rem;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <div id="status-panel" class="state-warmup">
    <!-- HEADER -->
    <div id="header-bar">
      <div id="status-indicator">
        <span id="status-dot"></span>
        <span id="status-text">WARMING UP</span>
        <span id="live-message" class="typing-dots">Loading model into memory...</span>
      </div>
      <div id="header-right">
        <div id="badges">
          <span class="badge" id="badge-transcriber">Turbo</span>
          <span class="badge" id="badge-processor">Local</span>
          <span class="badge" id="badge-auth">LOC</span>
        </div>
        <div id="close-btn" title="Close">Ã—</div>
      </div>
    </div>

    <!-- LIVE STATUS (Removed separate container) -->
    <!-- <div id="live-status"> </div> -->

    <!-- MODE SELECTION -->
    <div id="mode-toggle-bar">
      <div class="mode-btn active" id="mode-standard">
        <span>Standard</span>
        <span class="mode-desc">General</span>
      </div>
      <div class="mode-btn" id="mode-prompt">
        <span>Prompt</span>
        <span class="mode-desc">Engineered</span>
      </div>
      <div class="mode-btn" id="mode-professional">
        <span>Professional</span>
        <span class="mode-desc">Polished</span>
      </div>
      <div class="mode-btn" id="mode-raw">
        <span>RAW</span>
        <span class="mode-desc">Whisper</span>
      </div>
    </div>

    <!-- TOGGLES -->
    <div id="toggles-bar">
      <label class="toggle-item">
        <div class="toggle-switch">
          <input type="checkbox" id="toggle-sound" checked />
          <span class="toggle-slider"></span>
        </div>
        <span class="toggle-label-text" id="label-sound">Sound: On</span>
      </label>

      <label class="toggle-item">
        <div class="toggle-switch">
          <input type="checkbox" id="toggle-cloud" />
          <span class="toggle-slider"></span>
        </div>
        <span class="toggle-label-text" id="label-cloud">Local</span>
      </label>

      <label class="toggle-item">
        <div class="toggle-switch">
          <input type="checkbox" id="toggle-additional-key" />
          <span class="toggle-slider"></span>
        </div>
        <span class="toggle-label-text" id="label-key">+Key: Off</span>
      </label>

      <label class="toggle-item">
        <div class="toggle-switch">
          <input type="checkbox" id="toggle-refine-mode" />
          <span class="toggle-slider"></span>
        </div>
        <span class="toggle-label-text" id="refine-mode-label">Refine: Auto</span>
      </label>
    </div>

    <!-- METRICS GRID (Consolidated) -->
    <div id="metrics-container">
      <!-- Row 1: Session Stats (4 cols) -->
      <div id="metrics-row-1">
        <div class="metric-cell">
          <div class="metric-value" id="stat-sessions">0</div>
          <div class="metric-label">Sess</div>
        </div>
        <div class="metric-cell">
          <div class="metric-value" id="stat-words">0</div>
          <div class="metric-label">Words</div>
        </div>
        <div class="metric-cell">
          <div class="metric-value" id="stat-speed">--</div>
          <div class="metric-label">WPM</div>
        </div>
        <div class="metric-cell">
          <div class="metric-value" id="stat-tokens">0</div>
          <div class="metric-label">Tok</div>
        </div>
      </div>

      <!-- Row 2: Performance Stats (5 cols) -->
      <div id="metrics-row-2">
        <div class="metric-cell">
          <div class="metric-value perf-green" id="stat-last">--</div>
          <div class="metric-label">Tot</div>
        </div>
        <div class="metric-cell" id="perf-rec-cell">
          <div class="metric-value perf-green" id="perf-rec">--</div>
          <div class="metric-label">Rec</div>
        </div>
        <div class="metric-cell" id="perf-trans-cell">
          <div class="metric-value perf-green" id="perf-trans">--</div>
          <div class="metric-label">Trns</div>
        </div>
        <div class="metric-cell" id="perf-proc-cell">
          <div class="metric-value perf-green" id="perf-proc">--</div>
          <div class="metric-label">Proc</div>
        </div>
        <div class="metric-cell" id="perf-inject-cell">
          <div class="metric-value perf-green" id="perf-inject">--</div>
          <div class="metric-label">Inj</div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div
      style="width: 100%; text-align: center; display: flex; justify-content: center; gap: 4px; flex-wrap: wrap; font-size: 0.65rem; align-items: center;">
      Hotkeys:
      <span class="hk-tag" title="Dictate">Ctrl+Alt+D</span>
      <span class="hk-tag" title="Refine">Ctrl+Alt+R</span>
      <span class="hk-tag" title="Ask">Ctrl+Alt+A</span>
      <span class="hk-tag" title="Note">Ctrl+Alt+N</span>
      <span class="hk-tag" title="Translate">Ctrl+Alt+T</span>
    </div>
  </footer>

  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self';" />
  <script src="./renderer.js"></script>
</body>

</html>